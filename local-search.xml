<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Hello Git</title>
    <link href="/2023/03/16/hello-git/"/>
    <url>/2023/03/16/hello-git/</url>
    
    <content type="html"><![CDATA[<p>Git å…¥é—¨ç¬”è®°ï¼Œå¸¦ä½ å¿«é€Ÿä½¿ç”¨ Git Bash å‘½ä»¤</p><h1 id="Git-å…¥é—¨"><a href="#Git-å…¥é—¨" class="headerlink" title="Git å…¥é—¨"></a>Git å…¥é—¨</h1><p>git åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶</p><p>è®°å½•ç‰ˆæœ¬å· ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰ï¼ˆé«˜æ•ˆçš„å‹ç¼©è§£å‹ç®—æ³•ï¼‰</p><h2 id="æœ¬åœ°åº“"><a href="#æœ¬åœ°åº“" class="headerlink" title="æœ¬åœ°åº“"></a>æœ¬åœ°åº“</h2><p>æœ¬åœ°ç»“æ„</p><pre><code class="hljs">1. æœ¬åœ°åº“1. æš‚å­˜åŒº1. å·¥ä½œåŒº</code></pre><h4 id="git-init"><a href="#git-init" class="headerlink" title="git init"></a>git init</h4><p>åˆå§‹åŒ–æœ¬åœ°åº“</p><h4 id="git-add-git-commit"><a href="#git-add-git-commit" class="headerlink" title="git add git commit"></a>git add <strong>git commit</strong></h4><p>å·¥ä½œåŒº -ã€‹<strong>git add</strong> ã€ã€‘æš‚å­˜åŒº -ã€‹<strong>git commit</strong> ã€ã€‘ æœ¬åœ°åº“</p><p>å·¥ä½œåŒº ä¸‹ï¼ˆ.git åŒçº§ï¼‰æœª git add</p><p>ç¼“å­˜åŒº å·²ç» git add æœª git commit</p><h4 id="git-status"><a href="#git-status" class="headerlink" title="git status"></a>git status</h4><p>æŸ¥çœ‹å·¥ä½œçŠ¶æ€</p><h4 id="git-log"><a href="#git-log" class="headerlink" title="git log"></a>git log</h4><p>æäº¤æ—¥å¿—ï¼ˆç”±è¿‘åˆ°è¿œï¼‰</p><p>æ¯ä¸€æ¡å†…å®¹ æœ‰ä¸€ä¸ª key ç´¢å¼•å”¯ä¸€å¯¹åº”</p><p>ä¸åŒå±•ç¤ºæ ·å¼ï¼š</p><h5 id="git-log-â€“pretty-oneline"><a href="#git-log-â€“pretty-oneline" class="headerlink" title="git log â€“pretty=oneline"></a>git log â€“pretty=oneline</h5><h5 id="git-log-â€“oneline"><a href="#git-log-â€“oneline" class="headerlink" title="git log â€“oneline"></a>git log â€“oneline</h5><h5 id="git-reflog"><a href="#git-reflog" class="headerlink" title="git reflog"></a>git reflog</h5><h4 id="git-reset-â€“ã€ã€‘ç´¢å¼•"><a href="#git-reset-â€“ã€ã€‘ç´¢å¼•" class="headerlink" title="git reset â€“ã€ã€‘ç´¢å¼•"></a>git reset â€“ã€ã€‘ç´¢å¼•</h4><p>1.ä½¿ç”¨ hardï¼ˆä½¿ç”¨æœ€å¤šï¼‰</p><p>â€‹ æœ¬åœ°åº“çš„æŒ‡é’ˆç§»åŠ¨çš„åŒæ—¶ åŒæ­¥å·¥ä½œåŒºã€æš‚å­˜åŒºã€æœ¬åœ°åº“</p><p>2.ä½¿ç”¨ mixed</p><p>â€‹ æœ¬åœ°åº“çš„æŒ‡é’ˆç§»åŠ¨çš„åŒæ—¶ åŒæ­¥æš‚å­˜åŒºã€æœ¬åœ°åº“</p><p>2.ä½¿ç”¨ soft</p><p>â€‹ åªä¼šè®©æœ¬åœ°ç§»åŠ¨</p><h4 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h4><p>æ¯”è¾ƒå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å·®å¼‚ ï¼ˆå¸¦æ–‡ä»¶æ¯”æ–‡ä»¶ ï¼Œä¸å¸¦æ¯”æ‰€æœ‰ï¼‰</p><h3 id="åˆ†æ”¯"><a href="#åˆ†æ”¯" class="headerlink" title="åˆ†æ”¯"></a>åˆ†æ”¯</h3><p>æ–°å»ºåˆ†æ”¯ä¼šå…ˆå°†ä¸»åˆ†æ”¯çš„æœ€æ–°ç‰ˆæœ¬ç„¶ååŠ åˆ°åˆ†æ”¯</p><p><em>å„è‡ªåˆ†æ”¯ç›¸äº’ç‹¬ç«‹</em></p><h4 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a>git branch</h4><h5 id="git-branch-v"><a href="#git-branch-v" class="headerlink" title="git branch -v"></a>git branch -v</h5><p>â€‹ æŸ¥çœ‹å½“å‰æ‰€æœ‰åˆ†æ”¯</p><h5 id="git-branch-ã€ã€‘"><a href="#git-branch-ã€ã€‘" class="headerlink" title="git branch ã€ã€‘"></a>git branch ã€ã€‘</h5><p>åˆ›å»ºåˆ†æ”¯</p><h5 id="git-checkout-ã€ã€‘"><a href="#git-checkout-ã€ã€‘" class="headerlink" title="git checkout ã€ã€‘"></a>git checkout ã€ã€‘</h5><p>åˆ‡æ¢åˆ†æ”¯</p><p>ä¸»åˆ†æ”¯åˆå¹¶ å…¶ä»–åˆ†æ”¯</p><ol><li>åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯</li><li>ä½¿ç”¨ git merge ã€åˆ†æ”¯ã€‘ï¼ˆå½“ä¸»åˆ†æ”¯å’Œå…¶ä»–åˆ†æ”¯ éƒ½ä¿®æ”¹äº†åŒä¸€æ–‡ä»¶çš„åŒä¸€ä½ç½®å°±ä¼šå†²çªï¼‰</li><li>è§£å†³å†²çªæ–¹æ³•ï¼šç›´æ¥æ–‡ä»¶é€‰æ‹©æ€§åˆ é™¤ ï¼ˆå†æ·»åŠ  æäº¤ï¼‰</li></ol><h2 id="è¿œç¨‹åº“"><a href="#è¿œç¨‹åº“" class="headerlink" title="è¿œç¨‹åº“"></a>è¿œç¨‹åº“</h2><p><strong>github</strong></p><p><strong>gitee</strong></p><p><strong>gitlab</strong></p><h4 id="git-remote-add-ã€nameã€‘ã€https-â€¦-ã€‘"><a href="#git-remote-add-ã€nameã€‘ã€https-â€¦-ã€‘" class="headerlink" title="git remote add ã€nameã€‘ã€https://â€¦..ã€‘"></a>git remote add ã€nameã€‘ã€https://â€¦..ã€‘</h4><p>æœ¬åœ°åº“èµ·è¿œç¨‹åº“åˆ«å</p><h4 id="git-remote-v"><a href="#git-remote-v" class="headerlink" title="git remote -v"></a>git remote -v</h4><p>æŸ¥çœ‹åˆ«å</p><p><strong>git push ã€nameã€‘ã€åˆ†æ”¯ã€‘</strong></p><p>å‘è¿œç¨‹ä»“åº“ï¼ˆåˆ«åï¼‰æ¨é€ æœ¬åœ°ä»“åº“ çš„æŒ‡å®šåˆ†æ”¯</p><p><strong>git clone ã€https://â€¦..ã€‘</strong></p><p>åˆå§‹åŒ–æœ¬åœ°åº“ ä»è¿œç¨‹åº“å…‹éš†åˆ°æœ¬åœ° èµ·äº†åˆ«å origin</p><p><strong>åº“çš„æ‹¥æœ‰è€…æ‹‰å–</strong></p><ol><li>fetch +merge æ“ä½œ</li></ol><h5 id="git-fetch-ã€nameã€‘-ã€åˆ†æ”¯ã€‘"><a href="#git-fetch-ã€nameã€‘-ã€åˆ†æ”¯ã€‘" class="headerlink" title="git fetch ã€nameã€‘ ã€åˆ†æ”¯ã€‘"></a>git fetch ã€nameã€‘ ã€åˆ†æ”¯ã€‘</h5><p>ä»è¿œç¨‹åº“æŠ“å–åˆ°æœ¬åœ°åº“ï¼Œå·¥ä½œåŒºä¸å˜ è¿™æ—¶å€™æœ¬åœ°æœ‰ä¸ªåˆ†æ”¯æ˜¯ <strong>name/åˆ†æ”¯</strong></p><p>åˆ‡æ¢åˆ°æœ¬åœ° master åˆ†æ”¯ è°ƒç”¨ git merge name/åˆ†æ”¯ å°±å¯ä»¥åˆå¹¶</p><ol start="2"><li>pull æ“ä½œ</li></ol><h5 id="git-pullã€nameã€‘-ã€åˆ†æ”¯ã€‘"><a href="#git-pullã€nameã€‘-ã€åˆ†æ”¯ã€‘" class="headerlink" title="git pullã€nameã€‘ ã€åˆ†æ”¯ã€‘"></a>git pullã€nameã€‘ ã€åˆ†æ”¯ã€‘</h5><p>å†²çªäº§ç”Ÿ éœ€è¦åˆ°æœ¬åœ° è§£å†³å† push åˆ° è¿œç¨‹ä»“åº“</p><h2 id="å…å¯†æ“ä½œ"><a href="#å…å¯†æ“ä½œ" class="headerlink" title="å…å¯†æ“ä½œ"></a>å…å¯†æ“ä½œ</h2><p>$ ssh-keygen -t rsa -Cã€emailã€‘</p><h3 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h3><p>idea è¿œç¨‹ pull å‰æå‡†å¤‡</p><p>git pull origin master â€“allow-unrelated-histories</p><p>æ¨é€åˆ°ä¸Šæ¸¸å…¶å®ƒåˆ†æ”¯</p><p>git push â€“set-upstream origin myblogï¼ˆåˆ†æ”¯ï¼‰</p>]]></content>
    
    
    
    <tags>
      
      <tag>å·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebSocket å®ç°èŠå¤©å®¤</title>
    <link href="/2023/03/16/WebSocket%20%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E5%AE%A4/"/>
    <url>/2023/03/16/WebSocket%20%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E5%AE%A4/</url>
    
    <content type="html"><![CDATA[<h2 id="WebSockect-å®ç°èŠå¤©å®¤"><a href="#WebSockect-å®ç°èŠå¤©å®¤" class="headerlink" title="WebSockect å®ç°èŠå¤©å®¤"></a>WebSockect å®ç°èŠå¤©å®¤</h2><p><strong>è¯´æ˜ï¼šæœ€è¿‘äºŒæ‰‹äº¤æ˜“è¯¾è®¾æœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯å®ç° è´­ä¹°è€…å’Œå•†å“å‘å¸ƒè€…æœ‰ä¸€ä¸ªèŠå¤©å¯¹è¯çš„åŠŸèƒ½ï¼Œç±»ä¼¼äºå’¸é±¼çš„èŠå¤©å¯¹è¯åŠŸèƒ½å§ã€‚æƒ³åˆ°çš„å°±æ˜¯ WebSocket åè®®æ¥å®ç°ï¼Œé—®äº†ä¸€ä¸ªå‰ç«¯å°ä¼™ä¼´ï¼Œä»–ä¸€èˆ¬ä½¿ç”¨ socketio(ä¸€ä¸ª websocket æ¡†æ¶)ï¼Œæˆ‘çœ‹äº†ä¸‹ä¹Ÿæœ‰ java ç‰ˆçš„ï¼Œä½†æ€è€ƒäº†ä¸‹å†³å®šè¿˜æ˜¯ä½¿ç”¨åŸç”Ÿ websocket æ¥å†™å‰åç«¯ã€‚</strong></p><h4 id="ä»€ä¹ˆæ˜¯-websocketï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-websocketï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ websocketï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ websocketï¼Ÿ</h4><p>è¿™é‡Œæ”¾ä¸€ä¸ªçŸ¥ä¹çš„é«˜èµå›ç­”ï¼Œçœ‹å®Œå¾ˆæ¸…æ¥šã€‚<a href="https://www.zhihu.com/question/20215561/answer/40316953">WebSocket æ˜¯ä»€ä¹ˆåŸç†ï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥å®ç°æŒä¹…è¿æ¥ï¼Ÿ - Ovear çš„å›ç­” - çŸ¥ä¹</a></p><p>é¦–å…ˆæˆ‘ä»¬å…ˆè¯´è¯´å¤§å®¶éƒ½å¾ˆäº†è§£çš„ Http åè®®ï¼Œåœ¨ B/S å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨è¿™ç§åè®®æ¥è¿›è¡Œå„ç§å“åº”å’Œå¤„ç†ã€‚</p><p>ä»–çš„ç‰¹ç‚¹å°±æ˜¯ä¸€ä¸ª Request å’Œ ä¸€ä¸ª Response è€Œä¸”æ˜¯æ— çŠ¶æ€çš„ï¼ˆæƒ³è¦ä¿æŒçŠ¶æ€éœ€è¦é—´æ¥é€šè¿‡ session å’Œ cookieï¼‰ã€‚è™½ç„¶åœ¨ä¸€äº›ä¸é‚£ä¹ˆå¤æ‚çš„éœ€æ±‚ä¸‹ï¼Œè¿™æ ·çš„æœºåˆ¶å·²ç»è¶³å¤Ÿäº†ï¼Œä½†æ˜¯ä¸€äº›å¤æ‚çš„åº”ç”¨åœºæ™¯å¦‚éœ€è¦ä¸€ç›´ç›‘å¬æŸä¸ªæ•°æ®çš„å˜åŒ–å°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ ajax æ¥è½®è¯¢ï¼Œä½†è¿™æ ·å…¶å®æ˜¯éå¸¸ä½æ•ˆç‡çš„ï¼Œä½ æŠŠè‡ªå·±æƒ³æˆæœåŠ¡å™¨ï¼Œå‡è®¾æœ‰ä¸ªäººï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸€ç›´åœ¨ä½ è€³è¾¹å¨å¨ï¼ˆæ•°æ®æ›´æ–°äº†æ²¡ã€‚ã€‚ã€‚ï¼‰æˆ‘æƒ³ä½ ä¹Ÿä¸€å®šè¦ç–¯æ‰äº†å§ã€‚</p><div align=center><img src="https://yilin-1307688338.cos.ap-nanjing.myqcloud.com/blog/u=3797482105,2011720067&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto" alt="img" width="200"></div><p>å…¶æ¬¡ Http åè®®çš„å¦ä¸€ä¸ªç‰¹ç‚¹ï¼Œæµè§ˆå™¨åªèƒ½ä¸»åŠ¨å‘é€è¯·æ±‚æ¥æ”¶ä¿¡æ¯ï¼Œä¸èƒ½è¢«åŠ¨æ¥æ”¶æœåŠ¡å™¨ä¿¡æ¯ã€‚è¿™ä¸€ç‚¹ç¡®å®è›‹ç–¼ï¼Œä½¿å¾—ä¸€æ—¦æ•°æ®æœ‰äº†å˜åŒ–æˆ‘éœ€è¦è‡ªå·±å»è¯·æ±‚ï¼Œä½†æ˜¯æˆ‘åˆæ€ä¹ˆçŸ¥é“æ•°æ®ä»€ä¹ˆæ—¶å€™æ›´æ–°äº†å‘¢ï¼Ÿ</p><p>ç„¶é¹…ï¼Œwebsocket çš„å‡ºç°å°±å¯ä»¥å·§å¦™çš„è§£å†³è¿™äº›é—®é¢˜ã€‚</p><p>websocket åç”±æ¡æ‰‹å’Œæ•°æ®ä¼ è¾“æ„æˆ</p><p>æ¡æ‰‹åŸºäº HTTP åè®®ï¼Œç„¶åå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å®ç°é•¿è¿æ¥ï¼Œæ‰€ä»¥è¯´ websocket å’Œ http æ˜¯æœ‰äº¤é›†çš„ã€‚</p><p><img src="https://yilin-1307688338.cos.ap-nanjing.myqcloud.com/blog/6651f2f811ec133b0e6d7e6d0e194b4c_720w.webp" alt="å…³ç³»å›¾"></p><p>é‚£ä¹ˆæ•°æ®å¦‚ä½•ä¼ è¾“å‘¢ï¼Ÿåªéœ€è¦åœ¨æœåŠ¡ç«¯è®¾ç«‹è½¬å‘çš„æœåŠ¡ï¼Œé‚£ä¹ˆæ•°æ®å°±å¯ä»¥å®ç°ä» A å®¢æˆ·ç«¯åˆ° B å®¢æˆ·ç«¯çš„å‘é€ï¼Œæ‹¿èŠå¤©ä¸¾ä¾‹ï¼Œæ­£æ˜¯è¿™ç§é•¿è¿æ¥æœºåˆ¶ä»¥åŠå…è®¸å®¢æˆ·ç«¯ä¸»åŠ¨æ¥æ”¶æœåŠ¡ç«¯æ¶ˆæ¯çš„æœºåˆ¶ä½¿å¾—èŠå¤©æ¶ˆæ¯èƒ½å¤Ÿçœ‹ä¸Šå»å¥½åƒåœ¨ä¸¤ä¸ªå®¢æˆ·ç«¯å»ºç«‹äº†è¿æ¥ã€‚å…¶å®å°±æ˜¯æœåŠ¡å™¨åšäº†ä¸€æ¬¡è½¬å‘ã€‚</p><h4 id="Java-æ€ä¹ˆå†™æœåŠ¡ç«¯çš„-WebSocketï¼ˆSpringBootï¼‰"><a href="#Java-æ€ä¹ˆå†™æœåŠ¡ç«¯çš„-WebSocketï¼ˆSpringBootï¼‰" class="headerlink" title="Java æ€ä¹ˆå†™æœåŠ¡ç«¯çš„ WebSocketï¼ˆSpringBootï¼‰"></a>Java æ€ä¹ˆå†™æœåŠ¡ç«¯çš„ WebSocketï¼ˆSpringBootï¼‰</h4><p>éå¸¸ç±»ä¼¼ Servletï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å†™<strong>ServerEndPoint</strong></p><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦é‡å†™ä¸‰ä¸ªæ–¹æ³•</p><ol><li>onOpen(å»ºç«‹è¿æ¥æ—¶è‡ªåŠ¨è°ƒç”¨)</li><li>onMessage(æ¥æ”¶æ¶ˆæ¯æ—¶è‡ªåŠ¨è°ƒç”¨)</li><li>onClose(å…³é—­è¿æ¥æ—¶è‡ªåŠ¨è°ƒç”¨)</li></ol><p>å½“ç„¶è¿˜æœ‰ onError ç­‰æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">//è¿™ä¸ª æ³¨è§£ç±»ä¼¼httpçš„map ï¼Œæ¯”å¦‚è¯´è¿™æ ·ä½ çš„ websocket url å°±æ˜¯ wsï¼šlocalhost/chat</span><br><span class="hljs-meta">@ServerEndpoint(value = &quot;/chat&quot;,configurator = GetHttpSessionConfigurator.class)</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatEndPoint</span> &#123;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  å»ºç«‹è¿æ¥è¢«è°ƒ</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-meta">@OnOpen</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session, EndpointConfig config)</span>&#123;<br><br><br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¥æ”¶æ•°æ®è¢«è°ƒç”¨</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-meta">@OnMessage</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String message,Session session)</span>&#123;<br><br><br><br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å…³é—­è¿æ¥è°ƒç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@OnClose</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClose</span><span class="hljs-params">(Session session)</span>&#123;<br><br><br><br>    &#125;<br><br><br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¸Šé¢ session æŒ‡çš„æ˜¯ websocket çš„ sessionï¼Œä¸æ˜¯ http çš„ sessionï¼Œä¹Ÿæ˜¯ç”¨æ¥æ ‡è¯†æ¯ä¸€ä¸ªé•¿è¿æ¥çš„å¯¹è±¡ï¼Œçœ‹åˆ°è¿™é‡Œèªæ˜çš„å°ä¼™ä¼´åº”è¯¥èƒ½æƒ³åˆ°å®ç°æ¶ˆæ¯è½¬å‘å¯ä»¥ç”¨ session æ¥æ ‡è¯†æ¯ä¸€ä¸ªç”¨æˆ·ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬æƒ³è¦å®ç°èŠå¤©æ¶ˆæ¯è½¬å‘å¯ä»¥ä½¿ç”¨ map æ¥å­˜å‚¨ websocket çš„ sessionã€‚è¿™é‡Œæˆ‘å­˜å‚¨ EndPoint å®ä¾‹ç±»ä¼¼ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ endpoint å®ä¾‹æ¥è·å– session å¯¹è±¡ï¼Œè®°ä½æ¯ä¸€ä¸ªç”¨æˆ·è¿›è¡Œä¸€æ¬¡ websocket é•¿è¿æ¥ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ª endpoint å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * ç”¨æ¥å­˜å‚¨æ¯ä¸ªå®¢æˆ·ç«¯å¯¹è±¡å¯¹åº”çš„ChatEndpointå¯¹è±¡ key æ˜¯uid</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String,ChatEndPoint&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br></code></pre></td></tr></table></figure><p>è¯´åˆ°è¿™é‡Œæœ‰å°ä¼™ä¼´æƒ³é—®äº†ï¼Œé¡¹ç›®çš„ä¸€äº›æ•°æ®å­˜å‚¨åœ¨ HttpSession ä¸­æ—¢ç„¶ websocket æ˜¯åŸºäº http çš„ï¼Œé‚£ä¹ˆæˆ‘èƒ½ä¸èƒ½å–å‡º Httpsession åœ¨ Endpoint é‡Œä½¿ç”¨å•Šï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œåªéœ€è¦åœ¨ springboot é…ç½®ä¸­åœ¨æ³¨å…¥å¯¹è±¡å‰ ServerEndpointConfig æ”¾å…¥è¿™ä¸ª httpsession å°±å¯ä»¥äº†</p><p>é…ç½®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Configuration</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> ServerEndpointExporter <span class="hljs-title function_">serverEndpointExporter</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerEndpointExporter</span>();<br>    &#125;<br>&#125;<br><br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GetHttpSessionConfigurator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServerEndpointConfig</span>.Configurator &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">modifyHandshake</span><span class="hljs-params">(ServerEndpointConfig sec, HandshakeRequest request, HandshakeResponse response)</span> &#123;<br>        <span class="hljs-type">HttpSession</span> <span class="hljs-variable">httpSession</span> <span class="hljs-operator">=</span> (HttpSession)request.getHttpSession();<br><br>        <span class="hljs-comment">//å°†httpsessionå­˜åˆ°é…ç½®å¯¹è±¡</span><br><br>        sec.getUserProperties().put(HttpSession.class.getName(),httpSession);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@ServerEndpoint(value = &quot;/chat&quot;,configurator = GetHttpSessionConfigurator.class)</span><br><br></code></pre></td></tr></table></figure><p>è·å–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@OnOpen</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session, EndpointConfig config)</span>&#123;<br><br>       <span class="hljs-built_in">this</span>.session = session;<br><br>       <span class="hljs-comment">//è·å–Httpssion</span><br><br>      <span class="hljs-type">HttpSession</span> <span class="hljs-variable">httpSession</span> <span class="hljs-operator">=</span> (HttpSession) config.getUserProperties().get(HttpSession.class.getName());<br>      &#125;<br></code></pre></td></tr></table></figure><h4 id="å‰ç«¯æ€ä¹ˆå†™-WebSocket"><a href="#å‰ç«¯æ€ä¹ˆå†™-WebSocket" class="headerlink" title="å‰ç«¯æ€ä¹ˆå†™ WebSocket"></a>å‰ç«¯æ€ä¹ˆå†™ WebSocket</h4><p>å‰ç«¯å…¶å®ä¹Ÿç±»ä¼¼ï¼Œå†™èµ·æ¥æ›´ç®€å•ï¼Œåªéœ€è¦ new ä¸€ä¸ª websocket å¯¹è±¡å°±èƒ½å¤Ÿå®ç°è¿æ¥ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">ws</span>: <span class="hljs-built_in">any</span> = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-comment">//è¿æ¥</span><br>  <span class="hljs-title function_">connect</span>(<span class="hljs-params"></span>) &#123;<br>    ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&#x27;ws://localhost:8081/api/chat&#x27;</span>);<br>  &#125;,<br><span class="hljs-comment">//è·å–å®ä¾‹</span><br>  <span class="hljs-title function_">getWs</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> ws;<br>  &#125;,<br>  <span class="hljs-comment">//å…³é—­è¿æ¥ï¼Œåˆ é™¤å®ä¾‹</span><br><br>  <span class="hljs-title function_">removeWs</span>(<span class="hljs-params"></span>) &#123;<br>    ws.<span class="hljs-title function_">close</span>();<br>  &#125;,<br>&#125;;<br><br></code></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Typescript"><span class="hljs-comment">//è°ƒç”¨æ–¹æ³•</span><br>ws.<span class="hljs-title function_">connect</span>();<br><br>  ws.<span class="hljs-title function_">getWs</span>().<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>  &#125;;<br><br>  ws.<span class="hljs-title function_">getWs</span>().<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) &#123;<br>  &#125;<br>  ws.<span class="hljs-title function_">getWs</span>().<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>  &#125;;<br></code></pre></td></tr></table></figure><h4 id="èŠå¤©æ€ä¹ˆå®ç°"><a href="#èŠå¤©æ€ä¹ˆå®ç°" class="headerlink" title="èŠå¤©æ€ä¹ˆå®ç°"></a>èŠå¤©æ€ä¹ˆå®ç°</h4><p>æ€è·¯</p><ol><li> æ¯ä¸€ä¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥å°±å°† EndPoint å®ä¾‹å­˜å…¥ userHashMapï¼ˆè¿™é‡Œä½¿ç”¨é™æ€çš„ï¼‰ä¸­ã€‚</li><li> å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼Œå°±å°†æ­¤ç”¨æˆ·ä» userHashMap å»é™¤ï¼Œæ‰€ä»¥ userHashMap å§‹ç»ˆå­˜å‚¨åœ¨çº¿ç”¨æˆ·</li><li> å®¢æˆ·ç«¯å‘æ¶ˆæ¯ï¼Œæ¶ˆæ¯å†…å®¹éœ€è¦æœ‰å‘æ¶ˆæ¯äººï¼Œæ”¶æ¶ˆæ¯äººï¼Œå†…å®¹ï¼Œæ—¶é—´ï¼Œå°è£…æˆä¸€ä¸ªå¯¹è±¡ã€‚</li><li> æœåŠ¡ç«¯ onmessage æ¥æ”¶åˆ°å°±æ£€æŸ¥ç”¨æˆ·é‡Œ userHashMap æœ‰æ²¡æœ‰æ­¤äººï¼ˆæœ‰è¡¨ç¤ºåœ¨çº¿ï¼‰ï¼Œæœ‰å°±æ‰¾åˆ° session ç›´æ¥è½¬å‘ç»™ä»–ï¼Œæ²¡æœ‰éœ€è¦æš‚æ—¶å­˜å‚¨åˆ° chatsHashMapï¼Œå­˜æ¶ˆæ¯åˆ—è¡¨ ã€‚</li><li> é‚£ä¹ˆæˆ‘ä»¬è¿˜è¦ä¿®æ”¹ 1 æ­¥éª¤ï¼Œè¿™é‡Œè¿æ¥ä¸Šå°±è¦æ£€æŸ¥ chatsHashMap æœ‰æ²¡æœ‰è‡ªå·±çš„æ¶ˆæ¯ï¼Œæœ‰å°±è½¬å‘ç»™è‡ªå·±å¹¶å»é™¤ chatsHashMap çš„æ¶ˆæ¯ï¼Œè¿™æ ·ä¸€æ¥å°±å®ç°äº†ç¦»çº¿å’Œåœ¨çº¿ç”¨æˆ·çš„èŠå¤©åŠŸèƒ½ã€‚</li></ol><p>åç«¯å…¨éƒ¨ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ServerEndpoint(value = &quot;/chat&quot;,configurator = GetHttpSessionConfigurator.class)</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatEndPoint</span> &#123;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”¨æ¥å­˜å‚¨æ¯ä¸ªå®¢æˆ·ç«¯å¯¹è±¡å¯¹åº”çš„ChatEndpointå¯¹è±¡ key æ˜¯uid</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String,ChatEndPoint&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  ç”¨æ¥å­˜å‚¨æ¯ä¸ªå®¢æˆ·ç«¯å¯¹è±¡å¯¹åº”çš„èŠå¤©è®°å½• key æ˜¯uid value æ˜¯json</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String, ArrayList&lt;String&gt;&gt; chats = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * websocket session</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-keyword">private</span>  Session session;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * httpsession</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> HttpSession httpSession;<br><br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  å»ºç«‹è¿æ¥è¢«è°ƒ</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-meta">@OnOpen</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session, EndpointConfig config)</span>&#123;<br><br>        <span class="hljs-built_in">this</span>.session = session;<br><br>        <span class="hljs-comment">//è·å–Httpssion</span><br><br>       <span class="hljs-type">HttpSession</span> <span class="hljs-variable">httpSession</span> <span class="hljs-operator">=</span> (HttpSession) config.getUserProperties().get(HttpSession.class.getName());<br><br>       <span class="hljs-built_in">this</span>.httpSession = httpSession;<br><br><br>       <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> (User)httpSession.getAttribute(USER_LOGIN_STATE);<br><br><br><br>        <span class="hljs-comment">// å°†å½“å‰å¯¹è±¡å­˜å‚¨åœ¨ å®¹å™¨ä¸­ keyä¸ºuid</span><br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">uid</span> <span class="hljs-operator">=</span> String.valueOf(user.getUid());<br><br>       users.put(uid,<span class="hljs-built_in">this</span>);<br><br>       <span class="hljs-comment">// åˆ¤æ–­å¹¶å»ºç«‹ æš‚å­˜ èŠå¤©è®°å½•çš„æ•°æ®ç»“æ„</span><br><br>       <span class="hljs-keyword">if</span>(!chats.containsKey(uid)) &#123;<br><br>           ArrayList&lt;String&gt; arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>           System.out.println(uid+<span class="hljs-string">&quot;è°ƒç”¨äº†ä¸€æ¬¡&quot;</span>);<br>           chats.put(uid,arr);<br><br>       &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> MessageUtils.getMessage(<span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>, getUsers());<br><br>        System.out.println(message);<br>        <span class="hljs-comment">//è¿æ¥å°±ä¸€æ¡å¹¿æ’­</span><br>        broadcastAllUsers(MessageUtils.getMessage(<span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>,<span class="hljs-string">&quot;å½“å‰åœ¨çº¿ç”¨æˆ·äººæ•°ï¼š&quot;</span>+users.size()+<span class="hljs-string">&quot;äºº&quot;</span>));<br>        broadcastAllUsers(message);<br><br>        <span class="hljs-comment">//è·å–è¯¥ç”¨æˆ·æš‚å­˜ç¦»çº¿æ¶ˆæ¯å¹¶æ¨é€</span><br><br>        ArrayList&lt;String&gt; chatCache = chats.get(uid);<br><br><br>        <span class="hljs-keyword">for</span>(String chat:chatCache)&#123;<br><span class="hljs-comment">//            ChatEndPoint chatEndPoint = users.get(uid);</span><br><span class="hljs-comment">//            System.out.println(chat);</span><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-built_in">this</span>.session.getBasicRemote().sendText(chat);<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        chats.remove(uid);<br><br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å®¹å™¨é‡Œçš„ç”¨æˆ·</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Set&lt;String&gt; <span class="hljs-title function_">getUsers</span><span class="hljs-params">()</span>&#123;<br><br>        <span class="hljs-keyword">return</span> ChatEndPoint.users.keySet();<br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¨é€æ‰€æœ‰å®¢æˆ·ç«¯</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">broadcastAllUsers</span><span class="hljs-params">(String message)</span>&#123;<br><br>        Set&lt;String&gt; usersSet = users.keySet();<br>            <span class="hljs-keyword">try</span> &#123;<br><br>                <span class="hljs-keyword">for</span> (String user : usersSet) &#123;<br>                    <span class="hljs-type">ChatEndPoint</span> <span class="hljs-variable">chatEndPoint</span> <span class="hljs-operator">=</span> users.get(user);<br>                    chatEndPoint.session.getBasicRemote().sendText(message);<br>                &#125;&#125; <span class="hljs-keyword">catch</span>(IOException e)&#123;<br>                    e.printStackTrace();<br>                &#125;<br><br><br>            &#125;<br><br><br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¥æ”¶æ•°æ®è¢«è°ƒç”¨</span><br><span class="hljs-comment">     */</span><br><br>    <span class="hljs-meta">@OnMessage</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String message,Session session)</span>&#123;<br><br><br>        <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">mapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Message</span> <span class="hljs-variable">mess</span> <span class="hljs-operator">=</span> mapper.readValue(message, Message.class);<br><br><span class="hljs-comment">//            System.out.println(mess);</span><br><span class="hljs-comment">// æ¶ˆæ¯çš„æ¥æ”¶è€…</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">toUid</span> <span class="hljs-operator">=</span> mess.getToUid();<br><br>            <span class="hljs-type">ChatEndPoint</span> <span class="hljs-variable">chatEndPoint</span> <span class="hljs-operator">=</span> users.get(toUid);<br><br>            <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> (User)httpSession.getAttribute(USER_LOGIN_STATE);<br><br><br><br>            <span class="hljs-keyword">if</span>(chatEndPoint!=<span class="hljs-literal">null</span>)&#123;<br><br>                <span class="hljs-comment">// æ¥æ”¶ç”¨æˆ·åœ¨çº¿ç›´æ¥è½¬å‘</span><br><br><br><br>                <span class="hljs-keyword">if</span>(user==<span class="hljs-literal">null</span>)&#123;<br><br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(ErrorCode.LOGIN_ERROR);<br>                &#125;<br><br>                <span class="hljs-type">String</span> <span class="hljs-variable">message1</span> <span class="hljs-operator">=</span> MessageUtils.getMessage(<span class="hljs-literal">false</span>, user.getUserName(), user.getUid(),user.getPhone(), mess);<br><br>                chatEndPoint.session.getBasicRemote().sendText(message1);<br><br><br><br>            &#125;<span class="hljs-keyword">else</span>&#123;<br><br>                <span class="hljs-comment">//æ¥æ”¶ç”¨æˆ·ä¸åœ¨çº¿ å…ˆæš‚æ—¶å­˜å‚¨æ¶ˆæ¯</span><br><br>                ArrayList&lt;String&gt; messages = chats.get(toUid);<br><br>                <span class="hljs-keyword">if</span>(messages == <span class="hljs-literal">null</span>)&#123;<br>                    messages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>                    chats.put(toUid,messages);<br><br>                &#125;<br><br>                <span class="hljs-comment">//å­˜çš„å°±æ˜¯json</span><br>                messages.add(MessageUtils.getMessage(<span class="hljs-literal">false</span>, user.getUserName(), user.getUid(),user.getPhone(), mess));<br><br><br><br>            &#125;<br><br><br><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å…³é—­è¿æ¥è°ƒç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@OnClose</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClose</span><span class="hljs-params">(Session session)</span>&#123;<br><br><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> (User)httpSession.getAttribute(USER_LOGIN_STATE);<br><br>        users.remove(user.getUid().toString());<br><br>        System.out.println(user.getUserName()+<span class="hljs-string">&quot;ä¸‹çº¿äº†ï¼Œå½“å‰åœ¨çº¿äººæ•°ï¼š&quot;</span>+users.size()+<span class="hljs-string">&quot;äºº&quot;</span>);<br><br><br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å½“å‰æ—¶é—´æˆ³ï¼Œç§’</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getUnix</span><span class="hljs-params">()</span>&#123;<br><br>        <span class="hljs-type">long</span> <span class="hljs-variable">time</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br><br>        time = time / <span class="hljs-number">1000</span>;<br><br>        <span class="hljs-keyword">return</span> String.valueOf(time);<br><br>    &#125;<br><br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>å‰ç«¯æ¥æ”¶æ€ä¹ˆå­˜å‚¨å‘¢ï¼Ÿæˆ‘æš‚æ—¶åªæƒ³åˆ°å­˜å‚¨åœ¨ sessionStorage æˆ–è€… localStorage ä¸­ï¼Œä½†è¿™éƒ¨åˆ†æ•°æ®å­˜å‚¨éœ€è¦è€ƒè™‘å»é‡å’Œæ•°æ®å¯¹åº”æ¯ä¸ªç”¨æˆ·ï¼Œä¸è¦ç–å¿½äº†è®©åˆ«çš„ç”¨æˆ·çœ‹åˆ°äº†ä¸å±äºè‡ªå·±çš„å¯¹è¯å†…å®¹ï¼Œé‚£å°±å‡ºå¤§é—®é¢˜äº†ã€‚æ•´ä½“æ€è·¯æŒºç®€å•çš„å°±æ˜¯è¦ç»†å¿ƒã€‚</p><h4 id="å®ç°å±•ç¤º"><a href="#å®ç°å±•ç¤º" class="headerlink" title="å®ç°å±•ç¤º"></a>å®ç°å±•ç¤º</h4><p><img src="https://yilin-1307688338.cos.ap-nanjing.myqcloud.com/blog/image-20221125171042690.png" alt="image-20221125171042690"></p><p><img src="https://yilin-1307688338.cos.ap-nanjing.myqcloud.com/blog/image-20221125171211620.png" alt="image-20221125171211620"></p><p><img src="https://yilin-1307688338.cos.ap-nanjing.myqcloud.com/blog/image-20221125171244569.png" alt="image-20221125171244569"></p><p>ç»„ä»¶é‡‡ç”¨çš„æ˜¯ react-jwchat æ„Ÿè§‰æŒºå¥½çœ‹çš„ï¼Œå„é¡¹åŠŸèƒ½éƒ½æ­£å¸¸ï¼Œå°±æ˜¯æœ‰æ—¶å€™ä¼š websocket è¿æ¥äº†å°±æ–­å¼€äº†ï¼ŒçŒœæµ‹æ˜¯æ²¡å†™ error å¤„ç†å§ã€‚</p><h4 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h4><p>æœ€åçœ‹æˆ‘çš„äºŒæ‰‹äº¤æ˜“ç³»ç»Ÿçš„å‰åç«¯æºç ï¼ˆwebsocket æºç ä¹Ÿåœ¨é‡Œé¢ï¼‰</p><p><a href="https://gitee.com/wx_504ae56474/react-jwchat">react-jwchat èŠå¤©ç»„ä»¶</a></p><p><a href="https://gitee.com/yilinyo/lkd-javee-trade-frontend">äºŒæ‰‹äº¤æ˜“ç³»ç»Ÿå‰ç«¯</a></p><p><a href="https://gitee.com/yilinyo/lkd-javaee-trade-backend">äºŒæ‰‹äº¤æ˜“ç³»ç»Ÿåç«¯</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>é¡¹ç›®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é±¼çš®ç”¨æˆ·ä¸­å¿ƒæ”¶è·</title>
    <link href="/2023/03/16/%E9%B1%BC%E7%9A%AE%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E6%94%B6%E8%8E%B7/"/>
    <url>/2023/03/16/%E9%B1%BC%E7%9A%AE%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E6%94%B6%E8%8E%B7/</url>
    
    <content type="html"><![CDATA[<h1 id="é±¼çš®ç”¨æˆ·ä¸­å¿ƒæ”¶è·"><a href="#é±¼çš®ç”¨æˆ·ä¸­å¿ƒæ”¶è·" class="headerlink" title="é±¼çš®ç”¨æˆ·ä¸­å¿ƒæ”¶è·"></a>é±¼çš®ç”¨æˆ·ä¸­å¿ƒæ”¶è·</h1><p>ç”¨æˆ·ä¸­å¿ƒèŠ±äº†å¤§æ¦‚30+å°æ—¶ çœ‹äº†ğŸŸæ‰€æœ‰è§†é¢‘</p><p>å€Ÿé‰´äº†éƒ¨åˆ†åŒå­¦çš„ ç¬”è®° ï¼Œè™½ç„¶è¿™ç§é¡¹ç›®ä»¥å‰ä¹Ÿåšè¿‡ï¼Œå¾ˆå¤šä¸œè¥¿ä¹‹å‰ä¹Ÿä½“éªŒè¿‡ï¼Œä½†è¿˜æ˜¯ä¸€æ­¥ä¸€æ­¥åœ° è·Ÿç€æ¥äº†ä¸€è¾¹å®Œæ•´çš„ï¼Œæ”¶è·ç¡®å®å¾ˆå¤šã€‚åŒæ—¶è¿™ä¸ªè¿‡ç¨‹è¿˜é¢å¤–è‡ªå·±è¡¥äº†å¾ˆå¤šç»†èŠ‚åŸºç¡€ã€‚</p><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><p>é¦–å…ˆæœ€å¤§çš„æ”¶è·åº”è¯¥ ä¸æ˜¯ä»£ç å±‚é¢çš„ å› ä¸ºä¸šåŠ¡å¾ˆç®€å•å°±æ˜¯æ™®é€šçš„å¯¹ç”¨æˆ·è¡¨çš„crudï¼Œè€Œåº”è¯¥æ˜¯æ•´ä¸ª åç«¯Java çš„å¼€å‘æµç¨‹å’Œè§„èŒƒ ï¼Œæ¯”å¦‚ä¸€äº›å·¥å…·ç±»ï¼Œè¯·æ±‚ç±»ï¼Œé”™è¯¯ç±»çš„å°è£…ï¼Œè¿™é‡Œå°¤å…¶æœ‰æ”¶è·çš„æ˜¯ businessé”™è¯¯ç±»çš„å¼•å…¥ å’Œ  GlobelExceptionHandel å¼•å…¥æ¥å¤„ç†é”™è¯¯ä¿¡æ¯ æ¥åƒå‰ç«¯æä¾›è§„èŒƒä»¥åŠå®‰å…¨æ¥å£æ•°æ®ã€‚å…¶æ¬¡å°±æ˜¯ ä¸€äº›é€»è¾‘ä¸Šçš„ç»†èŠ‚ï¼Œè¿˜æœ‰ä¸€äº›æ•æ·å¼€å‘çš„æ’ä»¶ã€‚æ•´ä¸ªåç«¯ æ„å»ºçš„æµç¨‹å’Œè¿‡ç¨‹æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ã€‚</p><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><p>ç„¶åå°±æ˜¯å‰ç«¯æ–¹é¢çš„ä¸€äº›ï¼Œè¿™é‡Œä¹‹å‰åªæœ‰ç®€å•ä¸‰ä»¶å¥—çš„åŸºç¡€ï¼Œè™½ç„¶èƒ½å¬æ‡‚ï¼Œä½†è¿˜æ˜¯ä¿ƒä½¿æˆ‘å»ç¨å¾®å…¥é—¨å­¦ä¹ äº† ä¸€ä¸‹Vueã€React è¿˜æœ‰TS ï¼Œæ¡†æ¶ä¸Šæ‰‹å¾ˆç®€å•ä½†ä¸ç†Ÿç»ƒï¼Œæ‰€ä»¥çœ‹ant design pro å’Œ umiæˆ‘çœ‹äº†å¥½å‡ éï¼Œå‹‰å¼ºèƒ½ç®€å•åº”ç”¨ï¼Œåœ¨å‰ç«¯è§†é¢‘ä¸­ æˆ‘è§‰å¾—æ¯”è¾ƒé‡è¦çš„æ”¶è·æ˜¯ å‰ç«¯è¿™äº›ä¸»æµæ¡†æ¶çš„ é¡¹ç›®ç»“æ„ ï¼Œæ— è®ºæ˜¯Vue reactè¿˜æ˜¯umi å…¶å®éƒ½å·®ä¸å¤šï¼Œæ‰€ä»¥å¬ä¸€éç†è§£å…¶å®ƒå¾ˆå¿«æ·ï¼Œç„¶åå°±æ˜¯tsçš„ç»†èŠ‚äº†ï¼Œtsç¡®å®å¯¹javaç¨‹åºå‘˜å¾ˆå‹å¥½ï¼Œå­¦äº†tsçš„ä¸€äº›è¯­æ³•ç†è§£ant design pro éå¸¸çš„ä¾¿æ·ï¼Œç„¶ååœ¨å‰ç«¯çš„ç»†èŠ‚å…¶å®æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚apiçš„å°è£…ä»¥åŠç»„ä»¶åº“çš„å¤ç”¨ã€è·¯ç”±çš„åˆ©ç”¨ã€ç”Ÿäº§æ¨¡å¼å¯¹proxyä»£ç†çš„åˆ©ç”¨ã€ä»¥åŠå¼‚æ­¥axiosè¯·æ±‚ï¼ˆumié‡Œçš„REQUESTï¼‰è¯·æ±‚æ‹¦æˆªå™¨ã€å“åº”æ‹¦æˆªå™¨ã€åŸºç¡€é…ç½®ç­‰ç­‰ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå‰ç«¯æ€»æ˜¯å¾ˆç»†ã€‚</p><h3 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h3><p>å“¦ï¼Œæœ‰ä¸€ç‚¹å°±æ˜¯ç™»å½•ä¿æŒç™»é™†çŠ¶æ€è¿™ä¸ªä»¥å‰æ²¡ç³»ç»Ÿå­¦ï¼Œåˆ©ç”¨è¿™ä¸ªantdesign çš„æ¡†æ¶å¤§æ¦‚ç†Ÿæ‚‰äº† æ•´ä¸ªæµç¨‹ å’Œ å¦‚ä½•å®ç°å‰åç«¯ ï¼Œä¹‹å‰ç¬”è®°æœ‰æåˆ°ã€‚</p><h3 id="å¤šç¯å¢ƒ"><a href="#å¤šç¯å¢ƒ" class="headerlink" title="å¤šç¯å¢ƒ"></a>å¤šç¯å¢ƒ</h3><p>å¤šç¯å¢ƒæŒ‡çš„æ˜¯åœ¨å‰ç«¯å’Œåç«¯è¦é…ç½® å¤šç§ç¯å¢ƒçš„æ•°æ® ï¼ˆæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€redisã€ç«¯å£ï¼‰åœ¨å¯åŠ¨æ—¶å¯ä¾›é€‰æ‹©</p><h3 id="éƒ¨ç½²ä¸Šçº¿"><a href="#éƒ¨ç½²ä¸Šçº¿" class="headerlink" title="éƒ¨ç½²ä¸Šçº¿"></a>éƒ¨ç½²ä¸Šçº¿</h3><p>ç„¶åå°±æ˜¯éƒ¨ç½²ä¸Šçº¿</p><p>è¿™é‡Œ åŸºç¡€çš„å‡ ä¸ªæ–¹å¼æˆ‘å°±ä¸è®²äº†ï¼Œä¸»è¦æ”¶è·åº”è¯¥æ˜¯Dockerå®¹å™¨éƒ¨ç½²å§ï¼Œå› ä¸ºå¾ˆæ—©å°±æƒ³å­¦äº†ä½†æ˜¯ä¸€ç›´æ²¡æœºä¼š.Docker å…¶å®å°±æ˜¯ æœåŠ¡å™¨é‡Œçš„æ¸…æ–°å°æœåŠ¡å™¨ï¼ˆæœ‰è‡ªå·±çš„ç«¯å£ã€ç›®å½•å•¥ï¼‰ ï¼Œåœ¨é‡Œé¢ä¸‹ç¯å¢ƒåªéœ€è¦å‡ è¡Œä»£ç  ï¼Œç„¶åæˆ‘ä»¬åˆ©ç”¨é•œåƒæ¥æ‰“åŒ… ä»£ç å’Œç¯å¢ƒï¼Œè¿™æ ·å½¢æˆä¸€ä¸ªåˆä¸€ä¸ªçš„å°è½¯ä»¶å°±èƒ½å¤Ÿ é€šè¿‡Docker æ¥è¿è¡Œï¼Œæ–¹ä¾¿å¿«æ·ä¸”ç‹¬ç«‹ã€‚</p><h3 id="è·¨åŸŸé—®é¢˜"><a href="#è·¨åŸŸé—®é¢˜" class="headerlink" title="è·¨åŸŸé—®é¢˜"></a>è·¨åŸŸé—®é¢˜</h3><p>ç„¶åæ˜¯è·¨åŸŸé—®é¢˜</p><p>ä¹‹å‰è§£å†³è¿‡è·¨åŸŸé—®é¢˜ï¼Œä½†æ²¡æœ‰å¸¦cookieè¿™æ¬¡å¸¦äº†cookie ç”±äºåšnginxä¹‹å‰æ²¡çœ‹é±¼çš®è§†é¢‘ è‡ªå·±æäº†åŠå¤© è¸©äº†å¥½å¤šå‘ï¼Œè¿™é‡Œçš„æ”¶è·å°±æ˜¯å‰ç«¯æºå¸¦ cookie å°±å¿…é¡»è¦åœ¨åç«¯è®¾ç½® è¿”å›å¤´è¦å¸¦ä¸Š å‡ ä¸ªé‡è¦çš„å¤´ï¼Œå°¤å…¶æ˜¯cookieè¦è®¾ç½®pathå’Œå½“å‰è¯·æ±‚urlä¿æŒä¸€è‡´ ï¼Œè¿™æ ·setcookieæ‰ä¼šç”Ÿæ•ˆã€‚è¿™é‡ŒNginxåå‘ä»£ç†éœ€è¦é…ç½®æ­£å¸¸</p><p>ç„¶åè¿˜æœ‰ä¸ä½¿ç”¨åå‘ä»£ç†ï¼Œç›´æ¥åç«¯ä¹Ÿæœ‰å‡ ç§è§£å†³æ–¹æ³•ã€‚</p><h3 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h3><p>ç„¶åæˆ‘ä¹Ÿè‡ªå·±æ‹“å±•äº†ä¸€äº›æ¥å£æ¯”å¦‚æŸ¥è¯¢ç­‰ç­‰</p><p>è¿™ä¸ªé¡¹ç›®åº”è¯¥ä¼šæˆä¸ºåé¢é¡¹ç›®ç”¨æˆ·çš„æ•°æ®ä¸­å¿ƒå§ï¼Œå¯ä»¥æ›´å•å¤šçš„æ‹“å±•ã€‚</p><p>æœ€åä¹Ÿå¸Œæœ›ä»¥åå†™è‡ªå·±é¡¹ç›®æ—¶æ—¶åˆ»è¦æé†’è‡ªå·±è¿™äº›è§„èŒƒï¼Œä»¥åè¦å¤šå›æ¥çœ‹çœ‹ï¼Œæ„Ÿè°¢é±¼çš®ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>å¿ƒå¾—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¼™ä¼´åŒ¹é…ç³»ç»Ÿæ”¶è·</title>
    <link href="/2023/02/05/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F%E6%94%B6%E8%8E%B7/"/>
    <url>/2023/02/05/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F%E6%94%B6%E8%8E%B7/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¼™ä¼´åŒ¹é…ç³»ç»Ÿæ”¶è·"><a href="#ä¼™ä¼´åŒ¹é…ç³»ç»Ÿæ”¶è·" class="headerlink" title="ä¼™ä¼´åŒ¹é…ç³»ç»Ÿæ”¶è·"></a>ä¼™ä¼´åŒ¹é…ç³»ç»Ÿæ”¶è·</h1><p>ä¼™ä¼´åŒ¹é…ç³»ç»Ÿå‰å‰ååèŠ±äº†40+å°æ—¶ï¼Œæœ€åå®Œæˆäº†è¿™ä¸ªåŸºäºVueã€Vantã€Vite ä»¥åŠSpringBootçš„ç§»åŠ¨ç«¯ é¡¹ç›®ï¼Œæœ‰äº†ç”¨æˆ·ä¸­å¿ƒçš„ åŸºç¡€æ¶æ„ï¼Œè¿™ä¸ªç³»ç»Ÿä¸»è¦å›´ç»•åŠŸèƒ½å¦‚ç”¨æˆ·ç»„é˜ŸåŒ¹é…ä»¥åŠæ€§èƒ½ä¼˜åŒ–è¿›è¡Œå¼€å‘ï¼Œç”±äºæ˜¯è½»é‡å‰ç«¯æ¡†æ¶ï¼Œå¼€å‘ä¸Šæ‰‹è¾ƒä¸ºå®¹æ˜“ã€‚</p><h2 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h2><p>æœ¬æ¬¡é¡¹ç›® çš„ Swagger + Knife4j æ¥å£æ–‡æ¡£çš„ å¼•å…¥ æå¤§çš„æé«˜äº†ä¹‹å‰å‰åç«¯è”è°ƒçš„æ•ˆç‡ï¼Œå¯ä»¥è‡ªåŠ¨æ ¹æ®Controllerä¸Šçš„handler æ–¹æ³•çš„å‚æ•° ç”Ÿæˆå¯¹åº”çš„ å‰ç«¯æ•°æ®æ ¼å¼ã€‚è¿™ä¸ªåœ¨æ—¥å¸¸å¼€å‘è¿˜æ˜¯å¾ˆå¸¸ç”¨çš„.</p><p>åœ¨ç™»å½•ä¼˜åŒ–æ—¶å¼•å…¥äº†åˆ†å¸ƒå¼Session, ä»¥å‰çš„ç™»å½•çš„Session æˆ‘ä»¬ æ˜¯ç›´æ¥å­˜åœ¨ä¸€å°æœºå™¨çš„æœåŠ¡ä¸Šï¼Œä½†å•ä¸ªSpringBoot session åº”ç”¨åªèƒ½åº”ç”¨æœ¬æœåŠ¡ã€‚å¦‚æœæˆ‘ä»¬å°†é¡¹ç›®æ‹†åˆ†æˆå¾®æœåŠ¡ æˆ– é›†ç¾¤éƒ¨ç½²ï¼ŒSessionçš„çŠ¶æ€å°±æ— æ³•å…±äº«,å¼•å…¥spring-session-data-redis å°±èƒ½å¤Ÿè½»æ¾çš„å°†Session ä¿¡æ¯åœ¨redisç»´æŠ¤ï¼Œå®ç°äº†åˆ†å¸ƒå¼Sessionã€‚</p><p>Redis åŸºäºå†…å­˜çš„ nosql æ•°æ®åº“ çš„å¼•å…¥è®©æˆ‘ä½“éªŒåˆ°å…¶æ€§èƒ½çš„å¼ºå¤§ï¼Œé™¤äº†è¿™ç§åˆ†å¸ƒå¼Sessionçš„åº”ç”¨ï¼Œå®ƒè¿˜èƒ½å¹¿æ³›çš„åº”ç”¨äºæ•°æ®ç¼“å­˜ï¼Œåœ¨æ­¤ç³»ç»Ÿçš„ç”¨æˆ·è¡¨æˆ‘æ’å…¥äº†å¤§é‡çš„æ¨¡æ‹Ÿç”¨æˆ·ï¼Œå¯¼è‡´æŸ¥è¯¢æ€§èƒ½å¤§å¤§ä¸‹é™ï¼Œåç«¯å“åº”åˆ°å‰ç«¯çš„æ—¶é—´å¤§æ¦‚è¦èŠ±10æ¥ç§’ã€‚è¿™æ ·ä¸€æ¥ç”¨æˆ·çš„ä½“éªŒæ„Ÿä¼šå¤§å¤§ä¸‹é™ã€‚åˆ©ç”¨redis çš„ åŸºäºå†…å­˜çš„å­˜å‚¨ æˆåŠŸçš„å°† ç¬¬äºŒæ¬¡è®¿é—®çš„ é€Ÿåº¦é™ä½åˆ°äº†æ¯«ç§’çº§åˆ«ã€‚</p><p>å¥½åƒè®¡ç®—æœºçš„ä¸–ç•Œé‡Œ æ— è®ºé‡åˆ°ä»€ä¹ˆé—®é¢˜åŠ ä¸€å±‚ ç¼“å­˜æ€»èƒ½è§£å†³é—®é¢˜ã€‚ç„¶è€Œå¼•å…¥ ä¸€ä¸ªæ–°çš„ä¸œè¥¿æ€»ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚ä»ä¸šåŠ¡å±‚é¢æ¥è¯´å°±æ˜¯ æˆ‘ä»¬éœ€è¦ç»´æŠ¤ æ•°æ®åº“å’Œç¼“å­˜çš„æ•°æ®ä¸€è‡´ï¼Œä½†æ—¢ç„¶å­˜åœ¨ç¼“å­˜æˆ‘ä»¬å°±ä¸å¯é¿å… ä¸¤è€…çš„æ•°æ® ä¼šå‡ºç°ä¸ä¸€è‡´ï¼Œè¦åšçš„å°±æ˜¯å°†è¿™ç§æƒ…å†µå¸¦æ¥æŸå¤±é™ä½ï¼Œæ¯”å¦‚è®¾ç½®åˆé€‚çš„è¿‡æœŸæ—¶é—´ï¼Œæ—¢èƒ½å¸¦ç»™ç”¨æˆ·è‰¯å¥½çš„ä½“éªŒä¹Ÿä¸è‡³äºæ•°æ®é•¿æ—¶é—´ä¸æ›´æ–°ã€‚å…¶æ¬¡å°±æ˜¯å°±æ˜¯åªå¯¹å˜åŒ–ä¸æ˜æ˜¾çš„æ•°æ®ä½¿ç”¨ç¼“å­˜ï¼Œè¿™æ ·ç”¨æˆ·æ„ŸçŸ¥ä½“éªŒä¼šå¾ˆå°‘ã€‚ä»æ€§èƒ½å±‚é¢æ¥è¯´å°±æ˜¯redisåˆ©ç”¨äº†å†…å­˜ï¼Œæˆ‘ä»¬ä¸èƒ½é•¿æ—¶é—´å æœ‰ï¼Œæ‰€ä»¥ç¼“å­˜çš„æ•°æ®é‡ä¸€å®šè¦åˆé€‚ï¼Œè€Œä¸”ä¸€å®šè¦è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¸€æ—¦å†…å­˜çˆ†äº†ï¼Œä¸ç„¶ä¸ä½†æå‡ä¸äº†æ€§èƒ½è¿˜ä¼šé™ä½æ€§èƒ½ï¼ŒåŒæ—¶redis è‡ªæˆ‘æ·˜æ±°æœºåˆ¶è¿˜ä¼šå°†é‡è¦æ•°æ®æ·˜æ±°æ‰ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚å°±æ˜¯ä½¿ç”¨äº†ç¼“å­˜å¯æ˜¯æˆ‘ä»¬æ¯æ¬¡ç¬¬ä¸€æ¬¡è®¿é—®è¿˜æ˜¯æ¯”è¾ƒæ…¢ï¼Œè¿™é‡Œæƒ³è¦ç¬¬ä¸€æ¬¡ä¹Ÿè¯»çš„æ˜¯ç¼“å­˜æ•°æ®å°±éœ€è¦ç¼“å­˜é¢„çƒ­ï¼Œç¼“å­˜é¢„çƒ­å¯ä»¥æ˜¯å®šæ—¶ä»»åŠ¡ä¹Ÿå¯ä»¥æ˜¯è§¦å‘æŸä¸ªäº‹ä»¶ã€‚ç„¶åè¿™é‡Œå¼•å‡ºäº†åŸºäºRedissonçš„åˆ†å¸ƒå¼é”(æ„Ÿè§‰è¿™é‡Œæœ‰ç‚¹ä¸ºäº†ç”¨è¿™ä¸ªæŠ€æœ¯è€Œç”¨äº†ğŸ™„) è§£å†³åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¤šä¸ªåº”ç”¨æœåŠ¡åªæƒ³æ‰§è¡Œä¸€æ¬¡ ç¼“å­˜é¢„çƒ­çš„å®šæ—¶ä»»åŠ¡ã€‚æœ‰ç‚¹ç±»ä¼¼çº¿ç¨‹é‡Œçš„locké”ï¼Œè®¾ç½®ç„¶åæŠ¢é”ç„¶åæ‰§è¡Œé¢„çƒ­ç„¶åé‡Šæ”¾é”.å¤šçº¿ç¨‹å’Œåˆ†å¸ƒå¼å…¶å®å°±å¥½åƒä¸€ä¸ªå¾®è§‚ä¸‹ä¸€ä¸ªå®è§‚ä¸‹çš„ç«äº‰å¯¹æ‰‹ï¼Œéƒ½æ˜¯ä¸ºäº†æŠ¢å¤ºèµ„æºï¼Œåªä¸è¿‡å‰è€…æ˜¯ä¸ºäº†æŠ¢å¤ºè®¡ç®—æœºèµ„æºï¼Œåè€…æ˜¯ä¸ºäº†æä¾›ç”¨æˆ·çš„æœåŠ¡çš„èµ„æºã€‚è¿™é‡ŒRedissonçš„Rlockè¿˜å®ç°äº†çœ‹é—¨ç‹—æœºåˆ¶ï¼Œå°±æ˜¯å¦‚æœä¸€ä¸ªæœåŠ¡æŠ¢åˆ°é”å åœ¨æ‰§è¡Œåˆ†å¸ƒå¼é”ä½çš„å†…å®¹æ—¶ å¦‚æœè¿‡äº†è®¾ç½®æœ€å¤§æ—¶é—´è¿˜æ²¡å®Œå°±ä¼šè‡ªåŠ¨ç»­æœŸä¸€æ®µæ—¶é—´ã€‚</p><p>è¿™ä¸ªé¡¹ç›®è¿ç”¨åˆ°çš„Redis å®¢æˆ·ç«¯æœ‰spring-boot-starter-data-redisã€Redisson åè€…æ¯”è¾ƒé«˜çº§æ”¯æŒçº¿ç¨‹å®‰å…¨åŒæ­¥ã€‚Rlockå°±æ˜¯é‡Œé¢çš„ã€‚å‰è€…æ˜¯SpringBootæ¨èçš„ã€‚è€Œä¸”é»˜è®¤ä½¿ç”¨äº†jdkçš„åºåˆ—åŒ–æ–¹æ³•ï¼Œå°±æ˜¯æœ€ååˆ°redisé‡Œéƒ½æ˜¯ä¸€å †ä¹±ç å…¶å®æ˜¯åºåˆ—åŒ–å·çš„ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶å…¶çš„åºåˆ—åŒ–æ–¹å¼å¢å¼ºå¯è¯»æ€§æˆ–è€…æ•ˆç‡,åªéœ€è¦å®šåˆ¶åŒ–é…ç½®redisTemplateçš„beanã€‚</p><p>ç„¶åå€¼å¾—ä¸€æçš„å°±æ˜¯æ•°æ®åº“è¡¨çš„å»ºç«‹ä»¥å‰éƒ½æ˜¯ä¸€å †æ•°æ®æ”¾åœ¨ä¸€å¼ è¡¨ï¼ŒæŸ¥èµ·æ¥ç¡®å®çˆ½ä½†æ˜¯æå¤§çš„æµªè´¹äº†æ€§èƒ½ï¼Œå¤§é‡çš„æ•°æ®å†—ä½™ã€‚ç»´æŠ¤ä¸€å¼ å…³ç³»è¡¨è™½ç„¶æ“ä½œèµ·æ¥éº»çƒ¦ä½†è¿˜æ˜¯èƒ½å‡å°‘IOï¼Œè®°å¾—ä½¿ç”¨äº‹ç‰©æ³¨è§£å°±è¡Œäº†ã€‚è¿™æ¬¡å¼€å‘åˆç†Ÿæ‚‰äº†ä¸‹mybatis plusã€‚å®ƒç¡®å®å¼ºå¤§ã€‚è®°å¾—è‡ªå·±å†™çš„sqlè¯­å¥æ²¡æœ‰è‡ªåŠ¨æ·»åŠ é€»è¾‘åˆ é™¤çš„æ¡ä»¶ã€‚</p><p>æœ€æœ€æœ€å¤§æ”¶è·å°±æ˜¯è¿™æ¬¡çš„ä¸šåŠ¡é€»è¾‘äº†ï¼Œè¿™æ¬¡çœŸçš„æ˜¯ç»å†äº†ä¸šåŠ¡çš„å®Œæ•´æµç¨‹ï¼Œé¦–å…ˆä¸€å®šè¦æƒ³å¥½éœ€æ±‚åˆ†æå†æƒ³å¥½æ€ä¹ˆå®ç°ï¼Œæ•´ä¸ªé¡¹ç›®æœ€å¤šçš„åœ°æ–¹å°±æ˜¯åœ¨é‰´æƒï¼Œå› ä¸ºé˜Ÿä¼çš„åˆ›å»ºè€…ä»¥åŠé˜Ÿä¼çš„çŠ¶æ€æ˜¯æœ‰åŒºåˆ«çš„ã€‚æˆ‘ä»¬éœ€è¦å±‚å±‚çš„åˆ¤æ–­æ˜¯å¦æœ‰æƒé™è¿›è¡Œæ“ä½œä¸ç„¶å°±ä¼šå‡ºç°é—®é¢˜ï¼Œæœ‰äº›é‰´æƒå¯ä»¥ç›´æ¥åˆ¤æ–­ï¼Œè€Œæœ‰ä¸€äº›é‰´æƒéœ€è¦æŸ¥æ•°æ®åº“æ¯”å¦‚ä¸€ä¸ªäººæœ€å¤šåŠ å…¥5ä¸ªé˜Ÿä¼ï¼Œæˆ‘ä»¬è¦å°½é‡è®©é‚£äº›ä¸è¦æŸ¥æ•°æ®åº“çš„é‰´æƒåœ¨å‰é¢æ£€æŸ¥ä»¥å‡å°‘æ•°æ®åº“çš„è®¿é—®ã€‚åœ¨å¼€å‘è¿‡ç¨‹å°½é‡ä¸è¦ç›´æ¥ä¼ é€’æ•°æ®åº“çš„æŸ¥è¯¢å¯¹è±¡ï¼Œå¤šå°è£…dtoï¼Œvoæ¥éš”ç¦»åŸå§‹æ•°æ®ï¼Œä¿è¯æ•°æ®å®‰å…¨å’Œæ•°æ®æ ¼å¼ç»Ÿä¸€ã€‚å¿…è¦çš„æ—¶å€™å¯¹äºç›¸åŒçš„ä¹Ÿé€»è¾‘è¦æ•´ä½“æŠ½ç¦»ã€‚</p><p>ç®—æ³•è¿™ä¸€å—ç”¨çš„æ˜¯dpå®ç°çš„æœ€å°ç¼–è¾‘è·ç¦»æ–¹æ³•ï¼Œæ„Ÿè§‰è¿™ä¸ªç®—æ³•è¿˜æ˜¯æœ‰å±€é™æ€§çš„ï¼Œå¯ä»¥å®ç°æ›´å¥½çš„åŒ¹é…æˆ–è€…æ¨èç®—æ³•ï¼Œåç»­æœ‰æœºä¼šæˆ‘å†è¯•ä¸€è¯•ã€‚</p><h2 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h2><p>å‰ç«¯è¿™æ¬¡ç”¨çš„3Vä¸‰å‰‘å®¢ï¼Œæ€»ä½“æ¥è¯´æ¯”è¾ƒè½»é‡ï¼Œè¿™æ¬¡åŸºæœ¬å­¦ä¼šäº†å…¶ä½¿ç”¨æ–¹æ³•ï¼Œè¿™æ¬¡ğŸŸå¸¦æˆ‘ä»¬å®ç°äº†ä¹‹å‰ç”¨æˆ·ä¸­å¿ƒä»–ä»¬å®ç°çš„ä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚å¦‚å’Œè‡ªå·±å°è£…axios å…¨å±€æ‹¦æˆªå™¨ï¼Œæ¯”å¦‚è‡ªå·±å®ç°ç”¨æˆ·ç¼“å­˜ï¼Œæ¯”å¦‚vue routerè·³è½¬ç­‰ç­‰ï¼Œäº†è§£åˆ°äº†Vueå¼€å‘é¡¹ç›®çš„ç»“æ„ï¼Œæ¯”å¦‚è®¾ç½®æ¨¡æ¿è®¾ç½®ç»„ä»¶è®¾ç½®è·¯ç”±é¡µé¢ï¼Œå…¶å®è¿™ä¸ªé¡¹ç›®å°±æ˜¯ä¸€ä¸ªå•é¡µé¢é¡¹ç›®ï¼ŒVue-routerç¡®å®æ–¹ä¾¿ã€‚æ€»ä½“ä¸ŠVue3å’ŒReactè¿˜æ˜¯å¾ˆåƒçš„ï¼Œç”šè‡³æ›´ç®€å•ï¼Œv-ifï¼Œv-forå¤ªå¥½ç”¨äº†ï¼Œrefå“åº”å¼å˜é‡ä¹Ÿå¾ˆå¥½å¥½ç”¨ï¼Œå°±æ˜¯è¦æ³¨æ„Vueçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™äº›åœ¨åé¢å†åé¢ç»†ç»†å­¦ä¹ æŠŠ</p><h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>è¿™ä¸ªé¡¹ç›®è¿˜å¯ä»¥æ„å»ºå°ç¨‹åºç­‰ç­‰ï¼Œç”±äºèµ¶ç€æ€»ç»“é¡¹ç›®æ‰¾å®ä¹ å…ˆä¸å¼„äº†ï¼Œè¿™æ¬¡é¡¹ç›®åç«¯çŸ¥è¯†ç‚¹å¾ˆé›¶ç¢ä½†è¿˜æ˜¯ä¸ç®—å¤ªéš¾ï¼Œç„¶åå°±æ˜¯lambdaè¡¨è¾¾å¼æ“ä½œé›†åˆç±»æ˜¯çœŸçš„å¾ˆçˆ½ï¼ï¼ï¼ï¼</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
